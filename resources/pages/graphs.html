<!DOCTYPE HTML>
<HTML>
<HEAD>
	<link href="animations.css" type="text/css" rel="stylesheet">
	<link href="intro.css" type="text/css" rel="stylesheet">
	<link href="uielements.css" rel="stylesheet" type="text/css">
	<!--POWERHUB INTRO STARTUP SCREEN CODE (C) 2019 -->
	<!--MAIN SCREEN (C) 2019 -->
	<!--javascript-->
	<script src="jquery-3.4.1.min.js"></script>
	<script src="js-cookie.js"></script>
	<script src="plotly.js"></script>
	<script src="login.js"></script>
	<script>
	//autoLogin
	fgt = Cookies.get('fgt');
	// if(fgt!=undefined){
	// 	$.ajax({
	// 		type: 'POST',
	// 		url: '/wsgi_bin/login/',
	// 		data: JSON.stringify ({fgt: fgt}),
	// 		success: function(data){
	// 			if (data != "True"){
	// 				window.location.href = "/resources/pages/login.html";
	// 				Cookies.set('fgt','');
	// 			} else if (data == "True"){readData();};
	// 		},
	// 		contentType: "application/json",
	// 	});
	// } else {window.location.href = "/resources/pages/login.html";};
	window.onload = function(){
		if (Cookies.get('sesh') != "30000000"){
			document.getElementById("intro_logo").style.animationPlayState = "running" ;
			Cookies.set("sesh", "30000000");
		} else {
			document.getElementById("intro_logo").style.opacity = "0.5";
		}}
	//readData
	function readData(){
		$.ajax({
			type: 'POST',
			url: '/wsgi_bin/data/',
			data: JSON.stringify({fgt: fgt}),
			success: function(data){
				$('#voltage').html(data.voltage);
				$('#current').html(data.current);
				$('#wattage').html(data.voltage * data.current);
				$('#nodename').html(data.nodename);
				$('#firmware').html(data.firmware);
			},
			contentType: "application/json"
		});
	}
	//autorefresher
	var dyn = new Worker('dynamic.js');
	dyn.postMessage(fgt);
	dyn.onmessage = function(e) {
		data = JSON.parse(e.data);
		$('#voltage').html(data.voltage);
		$('#current').html(data.current);
		$('#wattage').html(data.voltage * data.current);
	};
</script>
<style>
	.navbuttons{
		height:18px;
		padding-top:10px;
		padding-bottom:10px;
	}
</style>
</HEAD>
<BODY>
	<script src="client.min.js"></script>
	<!--actual markup code here-->
	<div style="height:96px"></div><!--placeholder-->
	<img id="intro_logo" src="../logo1.png">
	<div class="navbuttons" onchange="modeChange()">Mode:<select id="mode"><option value="entire">Entire data log</option><option value="month">Single Month</option><option value="week">Single Week</option><option value="day">Single Day</option></select></div><br>
	<table id="data">
		<tr><td>Average Voltage<br><span id="voltage">---</span> V</td>
			<td>Average Current<br><span id="current">---</span> A</td>
			<td>Average Wattage<br><span id="wattage">---</span> W</td></tr>
			<tr><td colspan="2">Average Power Factor<br><span id="pf">---</span></td><td>Kilowatt-hours<br><span id="kwh">---</span></td></tr>
	</table>
	<div id="graph"></div>
	<iframe id="nav" src="nav.html?from=plot"></iframe>
	</BODY>
</HTML>


<!---dynamic shit here! -->
