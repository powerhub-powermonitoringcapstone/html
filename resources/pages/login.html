<!DOCTYPE HTML>
<HTML>
<HEAD>
<!--POWERHUB LOGIN CODE (C) 2019-->
	<link href="animations.css" type="text/css" rel="stylesheet">
	<link href="intro.css" type="text/css" rel="stylesheet">
	<style>
		body{
			background: rgb(20,21,38);				/* The rest of the styles are on the intro.css stylesheet*/
			color:#FFFFFF;
			width: 360px;
			margin: 0 auto;
		}
		#intro_logo{
			position:fixed;top:12px;
		}
	</style>
</HEAD>
<BODY>
	<!--ajax scripting start-->
	<script src="client.min.js"></script>
	<script src="jquery-3.4.1.min.js"></script>
	<script src="uuid_v4.js"></script>
	<script src="js-cookie.js"></script>
	<script>
		// time delta management
		var date = new Date();
		var minutes = false;
 		;
		fgt=Cookies.get('fgt');
		if(fgt==undefined){fgt=false};
		$.ajax({
			type: 'POST',
			url: '/wsgi_bin/login/',
			data: JSON.stringify ({fgt: fgt}),
			success: function(data){
				if (data == "True"){
						window.location.href = "/resources/pages/main.html";
					}
				},
			contentType: "application/json",
			});
		function Login(){
			var fgt=uuidv4();
			var auth=$('#password').val();
			var salt=uuidv4();
			var date=new Date();
			//minutes = false;
			$.ajax({
				type: 'POST',
				url: '/wsgi_bin/login/auth/',
				data: JSON.stringify ({fgt:fgt, auth:auth, salt:salt}),
				success: function(data){
					if (data == "True") //password correct
					{
						Cookies.set("fgt", fgt) // if ajax fails
						$.ajax({
							type: 'POST',
							url: '/wsgi_bin/settings/data/',
							success: function(data){
								minutes = data.permanence;
								date.setTime(date.getTime() + (minutes * 60 * 1000));
								if (minutes != 0){Cookies.set("fgt", fgt, { expires: date });};	
							},
							async: false
						});		
						window.location.href = "/resources/pages/main.html";			
 					} else{ //password wrong
						alert ("Wrong password!");
					}
				},
				contentType: "application/json",
			});
		}
		//jquery remember me
		function toggleClick(){
		if ($('#rememberMe').is(':checked')){
			$('#rememberMe').attr('checked', false);
			} else {
			$('#rememberMe').attr('checked', true);
			};
		}
	</script>	
	<!--end of ajax-->
	<div style="height:96px"></div><!--placeholder-->
	<img id="intro_logo" src="../logo1.png">
	<table id="login">
		<tr><td>Login:</td></tr>
		<tr><td><form onSubmit="Login()"><input type="password" id="password"></td></tr>
		<tr><td><input type="button" onClick="Login()" value="Submit"></td></tr>
		<tr><td><input type="checkbox" id="rememberMe" value="true"><span onclick="toggleClick()">Remember Me</span></td></tr>
		</form>
	</table>
</BODY>
</HTML>